# stat tracking
scoreboard players add .total_fish data 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_glowing_minnow=true}}] run scoreboard players add @s stat.fish.glowing_minnow 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_squishscale=true}}] run scoreboard players add @s stat.fish.squishscale 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_crimson_drifter=true}}] run scoreboard players add @s stat.fish.crimson_drifter 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_purple_shellfish=true}}] run scoreboard players add @s stat.fish.purple_shellfish 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_broken_fishing_rod=true}}] run scoreboard players add @s stat.fish.broken_fishing_rod 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_sunken_raft=true}}] run scoreboard players add @s stat.fish.sunken_raft 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_discarded_fuel_rod=true}}] run scoreboard players add @s stat.fish.discarded_fuel_rod 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_lost_soil_sample=true}}] run scoreboard players add @s stat.fish.lost_soil_sample 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_old_brush=true}}] run scoreboard players add @s stat.fish.old_brush 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_diving_mask=true}}] run scoreboard players add @s stat.fish.diving_mask 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_oxygen_tank=true}}] run scoreboard players add @s stat.fish.oxygen_tank 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_wetsuit_pants=true}}] run scoreboard players add @s stat.fish.wetsuit_pants 1
execute if entity @s[advancements={main:triggers/lobby/catch_item={catch_wetsuit_fins=true}}] run scoreboard players add @s stat.fish.wetsuit_fins 1
advancement revoke @s only main:triggers/lobby/catch_item

# check if ugly fish can spawn
execute if entity @n[tag=ugly_fish] run return 1
execute if score .limit_ugly_fish settings matches 1 if entity @n[tag=furniture.artifact.ugly_fish] run return 2

# roll for ugly fish
execute store result score .ugly_fish dummy run random value 1..100
execute unless score .ugly_fish dummy matches 1 run return fail

# if success, spawn ugly fish
tellraw @a {"translate":"message.purple.lobby.ugly_fish_appeared","fallback":"Something just surfaced in the lake...","color":"dark_aqua"}
execute positioned 10 10 10 run playsound minecraft:entity.generic.splash neutral @a ~ ~ ~ 3 0.7
execute positioned 10 10 10 run particle minecraft:splash ~ ~2 ~ 0.6 0.3 0.6 1 100 force @a
execute positioned 10 10 10 run summon tropical_fish ~ ~ ~ {Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish","ugly_fish"],Silent:1b,Invulnerable:1b,DeathLootTable:"minecraft:empty",PersistenceRequired:1b,CanPickUpLoot:0b,active_effects:[{id:"minecraft:invisibility",amplifier:0,duration:-1,show_particles:0b}],attributes:[{id:"minecraft:scale",base:1}],Passengers:[{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[-0.08005886f,-0.56099296f,0.70255995f,-0.43044955f],right_rotation:[0f,0f,0f,1f],translation:[-0.14249021f,-0.24536133f,-0.13760115f],scale:[0.24999443f,0.24999943f,0.25000486f]},item:{id:"minecraft:brain_coral_block",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.35481778f,-0.34609136f,0.14335571f,0.85660625f],right_rotation:[0f,0f,0f,1f],translation:[0.0634768f,-0.25f,-0.11071828f],scale:[0.25f,0.24999999f,0.24999996f]},item:{id:"minecraft:brain_coral_block",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.14335574f,0.85660636f,-0.35481787f,0.34609142f],right_rotation:[0f,0f,0f,1f],translation:[-0.1093117f,-0.25f,0.06820944f],scale:[0.25000003f,0.25000003f,0.25f]},item:{id:"minecraft:brain_coral_block",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.7238304f,0.48122722f,0.3592199f,0.33978063f],right_rotation:[0f,0f,0f,1f],translation:[-0.184133f,-0.14062497f,0.2131684f],scale:[0.2498773f,0.25002015f,0.25010103f]},item:{id:"minecraft:prismarine_shard",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.53972167f,0.7489955f,0.16346398f,0.3478306f],right_rotation:[0f,0f,0f,1f],translation:[-0.18490428f,-0.12499997f,0.16898096f],scale:[0.24962664f,0.2502463f,0.25012892f]},item:{id:"minecraft:prismarine_shard",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.81189626f,0.22056669f,0.5403358f,0.014559224f],right_rotation:[0f,0f,0f,1f],translation:[-0.22870608f,-0.171875f,0.19184598f],scale:[0.19999933f,0.19998454f,0.2000162f]},item:{id:"minecraft:prismarine_shard",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.69610786f,-0.34912598f,0.5920518f,0.20741138f],right_rotation:[0f,0f,0f,1f],translation:[-0.25717348f,-0.203125f,-0.031136438f],scale:[0.25010368f,0.24980482f,0.07815408f]},item:{id:"minecraft:brain_coral_block",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.25948954f,0.9067145f,-0.2895267f,0.16342627f],right_rotation:[0f,0f,0f,1f],translation:[0.018515825f,-0.24701172f,0.2133723f],scale:[0.24951196f,0.25071177f,0.1561108f]},item:{id:"minecraft:brain_coral_block",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.14804143f,-0.35840118f,0.8824593f,0.26626632f],right_rotation:[0f,0f,0f,1f],translation:[-0.11471075f,-0.10937497f,-0.24110265f],scale:[0.24988571f,0.25011313f,0.25000238f]},item:{id:"minecraft:ender_eye",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.74690264f,0.15739554f,0.3727339f,0.5276671f],right_rotation:[0f,0f,0f,1f],translation:[-0.27713564f,-0.15624997f,-0.050413653f],scale:[0.09597204f,0.09179266f,0.09353296f]},item:{id:"minecraft:ender_eye",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[-0.07766619f,-0.45226058f,0.88761544f,-0.039587453f],right_rotation:[0f,0f,0f,1f],translation:[-0.03680429f,-0.1875f,-0.20931183f],scale:[0.25006434f,0.24992064f,0.0781298f]},item:{id:"minecraft:brain_coral_block",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.5554954f,-0.028644472f,0.49134412f,0.67021304f],right_rotation:[0f,0f,0f,1f],translation:[-0.2573558f,-0.12499997f,-0.1833616f],scale:[0.18746668f,0.1876836f,0.18735155f]},item:{id:"minecraft:ender_eye",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.37655696f,0.61887574f,-0.40457192f,0.55813915f],right_rotation:[0f,0f,0f,1f],translation:[-0.22247984f,-0.07812497f,-0.08451834f],scale:[0.077594355f,0.080636635f,0.07620943f]},item:{id:"minecraft:ender_eye",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.50539565f,0.2304258f,0.12529512f,0.8220586f],right_rotation:[0f,0f,0f,1f],translation:[-0.19371486f,-0.17352295f,-0.27395344f],scale:[0.07864984f,0.077718616f,0.07801024f]},item:{id:"minecraft:ender_eye",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[-0.26488677f,-0.65561795f,0.65561795f,-0.26488677f],right_rotation:[0f,0f,0f,1f],translation:[-0.022479355f,-0.19615403f,-0.021708071f],scale:[0.2499994f,0.24999912f,0.2499991f]},item:{id:"minecraft:brain_coral_block",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.39480358f,0.69623697f,-0.58662605f,0.12350677f],right_rotation:[0f,0f,0f,1f],translation:[0.123636544f,-0.19371858f,0.11939438f],scale:[0.250617f,0.2499992f,0.15586437f]},item:{id:"minecraft:brain_coral_block",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[-0.25971794f,-0.5899178f,0.75007564f,0.14808717f],right_rotation:[0f,0f,0f,1f],translation:[0.17544585f,-0.19416776f,-0.026065603f],scale:[0.25006297f,0.24993831f,0.15624847f]},item:{id:"minecraft:brain_coral_block",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,Passengers:[{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.5345172f,0.8152079f,0.1891571f,0.11809752f],right_rotation:[0f,0f,0f,1f],translation:[0.12328237f,-0.12499997f,-0.20401435f],scale:[0.25008923f,0.25003704f,0.24987537f]},item:{id:"minecraft:prismarine_shard",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.97502995f,0.22201665f,-0.003370191f,-0.0037462474f],right_rotation:[0f,0f,0f,1f],translation:[0.13142943f,-0.1875f,-0.24438266f],scale:[0.19792558f,0.20056532f,0.2015279f]},item:{id:"minecraft:prismarine_shard",count:1}}],transformation:{left_rotation:[0.824373f,0.56069493f,0.072408214f,0.028063936f],right_rotation:[0f,0f,0f,1f],translation:[0.15079951f,-0.14062497f,-0.22363673f],scale:[0.24993159f,0.25017747f,0.2498911f]},item:{id:"minecraft:prismarine_shard",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.55545765f,-0.028702348f,0.49141604f,0.67018896f],right_rotation:[0f,0f,0f,1f],translation:[-0.18425614f,-0.06249997f,-0.14664732f],scale:[0.09375103f,0.09379291f,0.09370644f]},item:{id:"minecraft:ender_eye",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.27108088f,0.8866707f,0.10952383f,0.3582383f],right_rotation:[0f,0f,0f,1f],translation:[0.1798349f,-0.03124997f,0.17366455f],scale:[0.24999934f,0.2500004f,0.25000015f]},item:{id:"minecraft:amethyst_cluster",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.8739842f,0.30955082f,0.3531125f,0.12506661f],right_rotation:[0f,0f,0f,1f],translation:[0.3034715f,-0.12499997f,0.29305893f],scale:[0.43773037f,0.24986869f,0.20312499f]},item:{id:"minecraft:prismarine_shard",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.7548179f,0.53844196f,0.30496618f,0.21754459f],right_rotation:[0f,0f,-0.06964844f,0.99757165f],translation:[0.23603338f,-0.03124997f,0.22793473f],scale:[0.84378046f,0.24999157f,0.26562506f]},item:{id:"minecraft:prismarine_shard",count:1}},{id:"minecraft:item_display", Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"], teleport_duration:5,transformation:{left_rotation:[0.112995274f,0.9202727f,0.045653f,0.3718143f],right_rotation:[0f,0f,0f,1f],translation:[0f,0f,0f],scale:[0.25000015f,0.24999996f,0.25000012f]},item:{id:"minecraft:amethyst_cluster",count:1}},{id:"minecraft:interaction",width:0.7f,height:-0.4f,response:1b,Tags:["furniture.lost_artifact","furniture.lost_artifact.ugly_fish"]}]}
